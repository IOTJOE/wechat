webpackJsonp([1],{COg2:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7+uW"),n=a("zL8q"),i=a.n(n),r=(a("tvR6"),a("Xxa5")),o=a.n(r),c=a("exGp"),l=a.n(c),u=a("mtWM"),p=a.n(u),d={name:"App",data:function(){return{fileList:[],accounts_typeList:[],price:0,amount:100,trans_action:"BUY",trans_type:"LIMIT",price_type:"0",accounts_value:"all",action_type:"trans",orders_type:null,other_orders_value:"",result:"",positionsList:null,action_typeList:[{name:"下单",value:"trans"},{name:"撤单",value:"delete"},{name:"撤单全部",value:"delete_all"},{name:"生成调仓信号",value:"adjustments"},{name:"资金股份/投资组合",value:"positions"},{name:"查询订单",value:"orders"},{name:"查询状态",value:"statuses"},{name:"查询其他",value:"reports"},{name:"查询交易客户端状态",value:"clients"},{name:"更改交易客户端状态",value:"change_clients"},{name:"查询帐号",value:"accounts"}],orders_typeList:[{name:"查询当日委托",value:null},{name:"查询撤单",value:"open"},{name:"查询当日成交",value:"filled"}],trans_actionList:[{name:"买入",value:"BUY"},{name:"卖出",value:"SELL"},{name:"打新",value:"IPO"},{name:"融资买入",value:"BUY_ON_MARGIN"},{name:"卖券还款",value:"SELL_THEN_REPAY"}],trans_typeList:[{name:"限价单",value:"LIMIT"},{name:"市价单",value:"MARKET"}],price_typeList:[{name:"限价委托-全市场",value:"0"},{name:"五档即时成交剩余撤销-全市场",value:"4"},{name:"五档即时成交剩余转限-上海交易所",value:"6"},{name:"对手方最优价格委托-深圳交易所",value:"1"},{name:"本方最优价格委托-深圳交易所",value:"2"},{name:"即时成交剩余撤销委托-深圳交易所",value:"3"},{name:"全额成交或撤销委托-深圳交易所",value:"5"}],serverIp:"http://joemercy.xicp.net",direct_address:"http://iotjoe.eicp.net",redis_address:"https://minfo.gildata.com",myValue:"",storeList:[],multipleSelection:[],resultArr:[]}},beforeShow:function(){},methods:{getUser:function(){var e=this;p.a.get(this.serverIp+"/getUser").then(function(t){console.log(t.data),e.accounts_typeList=t.data}).catch(function(e){})},tradeAll:function(){var e=l()(o.a.mark(function e(t){var a,s,n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=o.a.mark(function e(a){var s,i,r,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=t[a].userAccount,i=t[a].fileName,r=t[a].serverIp,c=t[a].transIp,console.log("账户:"+s+"文件服务器地址:"+r+"实盘易地址"+c),console.log("===>开始读取文件"+i),e.next=8,p.a.get(r+"/readCsv?userAccount="+s+"&fileName="+i).then(function(){var e=l()(o.a.mark(function e(t){var a,i,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("====>文件读取成功"),a=t.data,i=o.a.mark(function e(t){var i,l,u,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="",l=0,u="",0===a[t].priceType?(u="LIMIT",l=0):1===a[t].priceType&&1===a[t].marketType?(u="MARKET",l=6):1===a[t].priceType&&2===a[t].marketType&&(u="MARKET",l=4),i=1===a[t].direction?"BUY":"SELL",d={userAccount:s,action:i,symbol:a[t].stockId,type:u,priceType:l,price:a[t].price,amount:a[t].amount,direction:a[t].direction,marketType:a[t].marketType,url:c+"/api/v1.0/orders?client=*:"+s},e.next=8,p.a.get(r+"/transPost",{params:d}).then(function(e){null!=e.data.id?a[t].id=e.data.id:a[t].id="null",null!=e.data.source?a[t].source=e.data.source:a[t].source="null",null!=e.data.message?a[t].message=e.data.message:a[t].message="null",console.log(e.data)}).catch(function(e){return e.data});case 8:case"end":return e.stop()}},e,n)}),l=0;case 4:if(!(l<a.length)){e.next=9;break}return e.delegateYield(i(l),"t0",6);case 6:l++,e.next=4;break;case 9:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){});case 8:case"end":return e.stop()}},e,n)}),s=0;case 2:if(!(s<t.length)){e.next=7;break}return e.delegateYield(a(s),"t0",4);case 4:s++,e.next=2;break;case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),sleep:function(e){for(var t=(new Date).getTime();(new Date).getTime()-t<e;);},deleteRow:function(e,t){t.splice(e,1)},choose:function(){if(console.log(this.action_type),"trans"===this.action_type){var e;e={action:this.trans_action,symbol:this.myValue.substring(0,6),type:this.trans_type,priceType:this.price_type,price:this.price,amount:this.amount,url:this.direct_address+"/api/v1.0/orders?client=*:"+this.accounts_value},this.doPostRequest("orders",e)}else if("delete"===this.action_type)this.doDeleteRequest("orders/"+this.other_orders_value);else if("delete_all"===this.action_type)this.doDeleteRequest("orders");else if("adjustments"===this.action_type);else if("accounts"===this.action_type)this.doGetRequest("accounts");else if("positions"===this.action_type)this.doGetRequest("positions");else if("orders"===this.action_type){if(null==this.orders_type)this.doGetRequest("orders");else if("open"===this.orders_type){var t={client:"account:"+this.accounts_value,status:"open"};this.doGetRequest("open",t)}else if("filled"===this.orders_type){var a={client:"account:"+this.accounts_value,status:"filled"};this.doGetRequest("open",a)}}else if("statuses"===this.action_type)this.doGetRequest("statuses");else if("reports"===this.action_type){var s={client:"account:"+this.accounts_value,navigation:this.other_orders_value};this.doGetRequest("reports",s)}else"clients"===this.action_type?this.doGetRequest("clients/"+this.other_orders_value):"change_clients"===this.action_type&&this.doPatchRequest("clients/"+this.other_orders_value)},getOrgCode:function(){var e=this;p.a.get(this.redis_address+"/memcached/json/?AStock_secuInfo").then(function(t){t?e.secuInfo=t.data:console.log("暂无此数据")})},getStore:function(e){var t=this.secuInfo,a=[];this.storeList=[];for(var s=0;s<t.length;s++)if(t[s].label.toLowerCase().indexOf(e.toLowerCase())>-1){var n=t[s].label.split(" ");t[s].secuCode=n[0],t[s].secuAbbr=n[1],t[s].market=n[2],t[s].py=n[3],a.push(t[s])}for(var i=a.length>10?10:a.length,r=0;r<i;r++)this.storeList.push(a[r])},getCompany:function(e,t,a){this.storeList=[],this.myValue=e+" "+t+" "+a,this.secuCode=e,this.doGetRequest("quotes/"+e)},doReadFileRequest:function(e){for(var t=this,a=[],s=0;s<e.length;s++){var n=e[s].userAccount,i=e[s].fileName,r=e[s].serverIp;p.a.get(r+"/readCsv?userAccount="+n+"&fileName="+i).then(function(e){for(var t in e.data)a.push(e.data[t])}).catch(function(e){t.result=e.data})}this.fileList=a},doPostRequest:function(e,t){var a=this;null==t&&(t={client:"*:"+this.accounts_value}),p.a.get(this.serverIp+"/transPost",{params:t}).then(function(e){console.log(e.data),a.resultArr.push(e.data)}).catch(function(e){return e.data})},doGetRequest:function(e,t){var a=this;console.log("============="+e),null==t&&(t={client:"*:"+this.accounts_value}),this.$axios.get("/api/v1.0/"+e,{params:t}).then(function(t){"positions"===e&&(a.positionsList=t.data,console.log(a.positionsList)),"orders"===e&&(a.positionsList=t.data)}).catch(function(e){console.log(e.data)})},soldOutToday:function(){var e=l()(o.a.mark(function e(t){var a,s,n=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=o.a.mark(function e(a){var s,i,r,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=t[a].userAccount,i=t[a].serverIp,r=t[a].transIp,console.log("账户:"+s+"文件服务器地址:"+i+"实盘易地址"+r),c={client:"*:"+s},console.log("===>开始读取数据"+s),e.next=8,p.a.get(i+"/getTraderLog?userAccount="+s).then(function(){var e=l()(o.a.mark(function e(t){var u,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("====>文件读取成功"),u=t.data,e.t0=o.a.keys(u);case 3:if((e.t1=e.t0()).done){e.next=12;break}if(d=e.t1.value,2!==u[d].direction||"下单成功"!==u[d].status){e.next=10;break}return console.log("=>开始撤单:"+u[d].transId),c={userAccount:s,orderId:u[d].transId,url:r+"/api/v1.0/orders/"},e.next=10,p.a.get(i+"/deleteOrder",{params:c}).then(function(){var e=l()(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("==>撤单成功:"+t.data);case 1:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("==>撤单失败:"+e.data)});case 10:e.next=3;break;case 12:return e.next=14,n.$axios.get("/api/v1.0/orders",{params:c}).then(function(){var e=l()(o.a.mark(function e(t){var c,l,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("======>查询今日委托成功"),console.log("======>委托结果转为数组"),c=n.getTableToArry(t.data),l=o.a.mark(function e(t){var l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(2!==u[t].direction){e.next=11;break}e.t0=o.a.keys(c);case 2:if((e.t1=e.t0()).done){e.next=11;break}if(l=e.t1.value,u[t].transId!==c[l].合同编号&&u[t].transId!==c[l].委托编号||!(c[l].委托数量-c[l].成交数量>0)){e.next=9;break}return e.delegateYield(o.a.mark(function e(){var d,v,h;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("卖出订单号="+u[t].transId),d=c[l].委托数量-c[l].成交数量,v=4,1===u[t].marketType&&(v=6),h={userAccount:s,action:"SELL",symbol:u[t].stockId,type:"MARKET",priceType:v,amount:d,direction:u[a].direction,marketType:u[a].marketType,url:r+"/api/v1.0/orders?client=*:"+s},e.next=7,p.a.get(i+"/transPost",{params:h}).then(function(e){e&&console.log("重新卖出成功:股票代码:"+u[t].stockId+"卖出数量:"+d+"返回信息:"+e.data)}).catch(function(e){console.log(e.data)});case 7:return e.abrupt("return","break");case 8:case"end":return e.stop()}},e,n)})(),"t2",6);case 6:if("break"!==e.t2){e.next=9;break}return e.abrupt("break",11);case 9:e.next=2;break;case 11:case"end":return e.stop()}},e,n)}),e.t0=o.a.keys(u);case 5:if((e.t1=e.t0()).done){e.next=10;break}return d=e.t1.value,e.delegateYield(l(d),"t2",8);case 8:e.next=5;break;case 10:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("==>查询今日委托失败:"+e.data)});case 14:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("===>读取文件失败:"+e.data)});case 8:case"end":return e.stop()}},e,n)}),s=0;case 2:if(!(s<t.length)){e.next=7;break}return e.delegateYield(a(s),"t0",4);case 4:s++,e.next=2;break;case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getTableToArry:function(e){for(var t=[],a=e.dataTable.columns,s=e.dataTable.rows,n=0;n<s.length;n++){for(var i={},r=0;r<s[n].length;r++)i[a[r]]=s[n][r];t.push(i)}return t},doDeleteRequest:function(e,t){var a=this;null==t&&(t={client:"*:"+this.accounts_value}),this.$axios.delete("/api/v1.0/"+e,{params:t}).then(function(e){console.log(e.data),a.result=e.data}).catch(function(e){a.result=e.data})},doPatchRequest:function(e,t){var a=this;null==t&&(t={client:"*:"+this.accounts_value}),this.$axios.patch("/api/v1.0/"+e,{params:t}).then(function(e){a.result=e.data,a.resultArr.push(e.data)}).catch(function(e){a.result=e.data})}},computed:{chooseAccount:function(){for(var e=[],t=0;t<this.accounts_value.length;t++)for(var a in this.accounts_typeList)this.accounts_typeList[a].userAccount===this.accounts_value[t]&&e.push(this.accounts_typeList[a]);return e},fileListRead:function(){for(var e=0;e<this.fileList.length;e++)1==this.fileList[e].direction?this.fileList[e].direction="买入":2==this.fileList[e].direction?this.fileList[e].direction="卖出":3==this.fileList[e].direction&&(this.fileList[e].direction="预卖"),0==this.fileList[e].priceType?this.fileList[e].priceType="限价":1==this.fileList[e].priceType&&(this.fileList[e].priceType="市价"),1==this.fileList[e].marketType?this.fileList[e].marketType="沪A":2==this.fileList[e].marketType&&(this.fileList[e].marketType="深A");return this.fileList}},created:function(){this.getOrgCode(),this.getUser()},filters:{}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[e._m(0),e._v(" "),a("div",{staticClass:"content"},[e._m(1),e._v(" "),a("section",{staticClass:"base_model"},[a("h2",[e._v("基础信息")]),e._v(" "),a("div",{staticClass:"base_content"},[a("div",{staticClass:"input_box"},[a("div",{staticClass:"left"},[a("el-select",{staticClass:"select_txt",attrs:{clearable:"",multiple:"",id:"price_type",placeholder:"账户"},model:{value:e.accounts_value,callback:function(t){e.accounts_value=t},expression:"accounts_value"}},e._l(this.accounts_typeList,function(e){return a("el-option",{key:e.userAccount,attrs:{label:e.name+e.broker+e.userAccount,value:e.userAccount}})})),e._v(" "),a("el-select",{staticClass:"select_txt",attrs:{id:"price_type",placeholder:"操作"},model:{value:e.action_type,callback:function(t){e.action_type=t},expression:"action_type"}},e._l(this.action_typeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),e._v(" "),a("el-select",{directives:[{name:"show",rawName:"v-show",value:"orders"==e.action_type,expression:"action_type=='orders'"}],staticClass:"select_txt",attrs:{clearable:"",id:"price_type",placeholder:"操作"},model:{value:e.orders_type,callback:function(t){e.orders_type=t},expression:"orders_type"}},e._l(this.orders_typeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"trans"==e.action_type,expression:"action_type=='trans'"}],staticClass:"input_txt",attrs:{clearable:"",placeholder:"公司名称或股票代码"},on:{input:function(t){e.getStore(e.myValue)},compositionend:function(t){e.getStore(e.myValue)}},model:{value:e.myValue,callback:function(t){e.myValue=t},expression:"myValue"}}),e._v(" "),this.storeList.length>0&&this.myValue?a("ul",{staticClass:"search_list"},e._l(this.storeList,function(t,s){return a("li",{key:"company"+s,on:{click:function(a){e.getCompany(t.secuCode,t.market,t.secuAbbr)}}},[a("p",[e._v(e._s(t.secuCode))]),e._v(" "),a("p",[e._v(e._s(t.market))]),e._v(" "),a("p",[e._v(e._s(t.secuAbbr))]),e._v(" "),a("p",[e._v(e._s(t.py))])])})):e._e(),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"trans"==e.action_type&&"LIMIT"==e.trans_type,expression:"action_type=='trans' && trans_type=='LIMIT' "}],staticClass:"input_txt",attrs:{placeholder:"价格",id:"price"},model:{value:e.price,callback:function(t){e.price=t},expression:"price"}}),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"trans"==e.action_type,expression:"action_type=='trans'"}],staticClass:"input_txt",attrs:{placeholder:"数量",id:"amount",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}}),e._v(" "),a("el-select",{directives:[{name:"show",rawName:"v-show",value:"trans"==e.action_type,expression:"action_type=='trans'"}],staticClass:"select_txt",attrs:{id:"trans_action",placeholder:"交易指令"},model:{value:e.trans_action,callback:function(t){e.trans_action=t},expression:"trans_action"}},e._l(this.trans_actionList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),e._v(" "),a("el-select",{directives:[{name:"show",rawName:"v-show",value:"trans"==e.action_type,expression:"action_type=='trans'"}],staticClass:"select_txt",attrs:{id:"trans_type",placeholder:"限价/市价"},model:{value:e.trans_type,callback:function(t){e.trans_type=t},expression:"trans_type"}},e._l(this.trans_typeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),e._v(" "),a("el-select",{directives:[{name:"show",rawName:"v-show",value:"trans"==e.action_type,expression:"action_type=='trans'"}],staticClass:"select_txt",attrs:{id:"price_type",placeholder:"价格类型"},model:{value:e.price_type,callback:function(t){e.price_type=t},expression:"price_type"}},e._l(this.price_typeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:"delete"==e.action_type||"clients"==e.action_type||"change_clients"==e.action_type||"reports"==e.action_type||"adjustments"==e.action_type,expression:"action_type=='delete' || action_type=='clients' || action_type=='change_clients' || action_type=='reports' || action_type=='adjustments'"}],staticClass:"input_txt",attrs:{placeholder:"单号/其他数据"},model:{value:e.other_orders_value,callback:function(t){e.other_orders_value=t},expression:"other_orders_value"}})],1),e._v(" "),a("div",{staticClass:"right"},[a("p",{directives:[{name:"show",rawName:"v-show",value:e.fileListRead.length>0,expression:"fileListRead.length>0"}]},[e._v("交易计划")]),e._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.fileListRead.length>0,expression:"fileListRead.length>0"}],ref:"multipleTable",staticStyle:{width:"1000px"},attrs:{data:e.fileListRead,"tooltip-effect":"dark","max-height":"250"}},[a("el-table-column",{attrs:{fixed:"",prop:"userAccount",label:"账户",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"stockId",label:"股票",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"direction",label:"方向",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"amount",label:"数量",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:"价格",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"priceType",label:"价格类型",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"marketType",label:"市场类型",width:"120"}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{on:{click:function(t){e.doReadFileRequest(e.chooseAccount)}}},[e._v("查看交易计划")]),e._v(" "),a("el-button",{on:{click:function(t){e.tradeAll(e.chooseAccount)}}},[e._v("全部挂单")]),e._v(" "),a("el-button",{on:{click:function(t){e.soldOutToday(e.chooseAccount)}}},[e._v("卖出今日到期票")])],1)],1)]),e._v(" "),a("div",{staticClass:"btn_box"},[a("el-button",{attrs:{type:"primary"},on:{click:e.choose}},[e._v("执行操作")])],1),e._v(" "),a("div",{staticClass:"result"},[null!=e.positionsList?a("div",[a("p",[e._v(e._s(e.positionsList.dataTable.columns))]),e._v(" "),a("p",[e._v(e._s(e.positionsList.dataTable.rows))])]):e._e()])])]),e._v(" "),a("section",{staticClass:"main_area"},[a("h2",[e._v("交互信息")]),e._v(" "),a("el-tabs",[a("el-tab-pane",{staticClass:"design_model clearfix",attrs:{label:"设计部分",name:"design"}},[null!=e.positionsList?a("div",[a("p",[e._v(e._s(e.positionsList.count))])]):e._e()]),e._v(" "),a("el-tab-pane",{staticClass:"business_model",attrs:{label:"业务部分",name:"business"}},[a("section",{staticClass:"index clearfix"},[a("div",{staticClass:"txt_index"},[a("h2",[e._v("文本指标")])]),e._v(" "),a("div",{staticClass:"num_index"},[a("h2",[e._v("数据指标")])])]),e._v(" "),a("div",{staticClass:"btn_box"},[a("el-button",{attrs:{type:"primary"}},[e._v("提交修改")])],1),e._v(" "),a("section",{staticClass:"model"})])],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"slide"},[t("i",{staticClass:"home"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"title_box"},[t("i",{staticClass:"star"}),this._v(" "),t("span",[this._v("量化下单平台")])])}]};var h=a("VU/8")(d,v,!1,function(e){a("COg2")},null,null).exports;s.default.use(i.a),s.default.prototype.$axios=p.a,p.a.defaults.baseURL="/api",p.a.defaults.headers.post["Content-Type"]="application/json",s.default.config.devtools=!0,s.default.config.productionTip=!1,new s.default({el:"#app",components:{App:h},template:"<App/>"})},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.02912f82e147c82ebc71.js.map